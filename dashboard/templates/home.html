{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<form method="post" action="/role/add" class="add-role-form">
  <input type="text" name="role_name" placeholder="New Role Name" required>
  <button type="submit">Add Role</button>
</form>

<table class="roles">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Toggle</th>
      <th>Add Keyword</th>
    </tr>
  </thead>
  <tbody>
  {% for role in roles %}
    <tr class="role-row {{ 'enabled' if role['enabled'] else 'disabled' }}" data-role="{{ role['role_id'] }}">
      <td><button type="button" class="toggle-keywords" data-role="{{ role['role_id'] }}">+</button></td>
      <td>{{ role['role_name'] }}</td>
      <td>
        <form method="post" action="/role/toggle/{{ role['role_id'] }}" class="inline-form">
          <button type="submit">{{ 'Disable' if role['enabled'] else 'Enable' }}</button>
        </form>
      </td>
      <td>
        <form method="post" action="/keyword/add/{{ role['role_id'] }}" class="add-keyword">
          <input type="text" name="keyword" placeholder="New keyword" required>
          <button type="submit">Add</button>
        </form>
      </td>
    </tr>
    {% for kw in role['keywords'] %}
    <tr class="keyword-row role-{{ role['role_id'] }} {{ 'enabled' if kw['enabled'] else 'disabled' }} hidden" data-keyword="{{ kw['keyword'] }}">
      <td></td>
      <td>{{ kw['keyword'] }}</td>
      <td>
        <form method="post" action="/keyword/toggle/{{ kw['keyword_id'] }}" class="inline-form">
          <button type="submit">{{ 'Disable' if kw['enabled'] else 'Enable' }}</button>
        </form>
      </td>
      <td></td>
    </tr>
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
{% endblock %}

