<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}Job Hunt{% endblock %}</title>
    <style>
        body { background-color:#2b2b2b; color:#f5f5f5; font-family:'Arial Narrow', Arial, sans-serif; margin:20px; }
        nav { background-color:#3a3a3a; padding:10px; margin-bottom:20px; }
        nav a { color:#f5f5f5; margin-right:15px; text-decoration:none; padding:5px 10px; border-radius:3px; }
        nav a.active, nav a:hover { background-color:#555; }
        table { border-collapse:collapse; width:100%; }
        th, td { border:1px solid #555; padding:2px 4px; font-size:12px; }
        th { background-color:#444; }
        th.count-col, td.count-col { width:60px; text-align:center; }
        th.actions, td.actions { width:40px; text-align:center; }
        th:first-child, td:first-child { width:20px; text-align:center; }
        tr.totals-row { background-color:#1a1a1a; }
        tr.role-row { background-color:#2a2a2a; }
        tr.keyword-row { background-color:#3a3a3a; }
        tr.role-row, tr.keyword-row, tr.listing-row { cursor:pointer; transition:background-color 0.2s; }
        tr.role-row:hover, tr.keyword-row:hover, tr.listing-row:hover { background-color:#555; }
        tr.new { background-color:#3b3b3b; }
        tr.applied { background-color:#2f3b2f; color:#cfc; }
        tr.ignored { background-color:#3b2f2f; color:#fcc; }
        button { background-color:#3a3a3a; color:#f5f5f5; border:1px solid #555; padding:2px 4px; border-radius:3px; cursor:pointer; }
        button:hover { background-color:#4a4a4a; }
        input { background-color:#444; color:#f5f5f5; border:1px solid #555; padding:2px 4px; }
        .inline-form { display:inline; }
        .hidden { display:none; }
    </style>
</head>
<body>
    <nav>
        <a href="/">Dashboard</a>
        <a href="/listings">Listings</a>
        <a href="/progress">Progress</a>
    </nav>
    {% block content %}{% endblock %}
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.role-row').forEach(function (row) {
            row.addEventListener('click', function (e) {
                if (['BUTTON','INPUT','A'].includes(e.target.tagName)) return;
                var roleId = row.dataset.role;
                document.querySelectorAll('.keyword-row.role-' + roleId).forEach(function (kwRow) {
                    kwRow.classList.toggle('hidden');
                });
            });
        });

        document.querySelectorAll('.add-keyword-btn').forEach(function (btn) {
            btn.addEventListener('click', function (e) {
                e.stopPropagation();
                var keyword = prompt('Enter new keyword:');
                if (keyword) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/keyword/add/' + btn.dataset.roleId;
                    var input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = 'keyword';
                    input.value = keyword;
                    form.appendChild(input);
                    document.body.appendChild(form);
                    form.submit();
                }
            });
        });

        document.querySelectorAll('.toggle-checkbox').forEach(function (cb) {
            cb.addEventListener('click', function (e) {
                e.stopPropagation();
            });
            cb.addEventListener('change', function (e) {
                e.target.closest('form').submit();
            });
        });

        document.querySelectorAll('.keyword-row').forEach(function (row) {
            row.addEventListener('click', function (e) {
                if (['BUTTON','INPUT','A'].includes(e.target.tagName)) return;
                var keyword = row.dataset.keyword;
                window.location.href = '/listings?keyword=' + encodeURIComponent(keyword);
            });
        });

        document.querySelectorAll('tr.listing-row').forEach(function (row) {
            row.addEventListener('click', function (e) {
                if (['BUTTON','A','INPUT'].includes(e.target.tagName)) return;
                var url = row.dataset.url;
                window.open(url, '_blank');
            });
        });
    });
    </script>
</body>
</html>

